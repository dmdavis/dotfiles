#!/usr/bin/env zsh

function vboxes {
    ssh-to vboxes ubuntu@10.5.108.203
}

# Use shattuck for unix password changes
function shattuck {
    ssh-to shattuck ddavis@shattuck.nbttech.com
}

function picrite {
    ssh-to picrite ddavis@picrite.lab.nbttech.com
}

function latite {
    ssh-to latite ddavis@latite.lab.nbttech.com
}

function vlab {
    ssh-to $1 root@$1.lab.nbttech.com
}

# Create a git repo at specified location. Ex: mkgit foo gmail <= use personal github email
function mkgit {
	local folder=$1
	mkdir ${folder}
	cd ${folder}
	git init
	if [ $2 == "gmail" ]; then
		githubmail
	fi
}

alias bento="$HOME/Source/github/chef/bento/bin/bento"
alias hippie="imgcat $HOME/Pictures/Hippie.png"

alias sw='/Users/ddavis/Source/gitlab/web3-sfcore/grunt.sh'
alias fw='/Users/ddavis/Source/gitlab/web3_framework/grunt.sh'
alias swsh='sw shell'
alias fwsh='fw shell'
function rpush {
    # -r, --recursive             recurse into directories
    # -l, --links                 copy symlinks as symlinks
    # -t, --times                 preserve times
    # -D                          same as --devices --specials
    #     --devices               preserve device files (super-user only)
    #     --specials              preserve special files
    # -h, --human-readable        output numbers in a human-readable format
    #     --progress              show progress during transfer
    rsync -rltDh --progress "$@"
}
function restart_cli_service {
    echo "$FG[green]Restarting $1 on $FG[yellow]$2.lab.nbttech.com$FG[none]"
    printf "en\npm proc $1 restart\n" | ssh root@$2.lab.nbttech.com cli
}
function clear_psp_cache {
    ssh root@$1.lab.nbttech.com rm -f /var/opt/tms/web/Cache/PSP/*
}
function swpush {
    sw install:remote --host=$1.lab.nbttech.com
}
function fwpush {
    fw install:remote --host=$1.lab.nbttech.com --refresh=1 --no_yui=1
}
function vapush_dva {
    echo "Syncing web2/appserver/Mgmt/Templates"
    rpush ~/Source/gitlab/va-product/mgmt/appliances/rbt_dva/src/bin/web2/appserver/Mgmt/Templates/ root@$1.lab.nbttech.com:/opt/tms/web2/appserver/Mgmt/Templates
    echo "Syncing web2/pythonlib"
    rpush ~/Source/gitlab/va-product/mgmt/appliances/rbt_dva/src/bin/web2/python/ root@$1.lab.nbttech.com:/opt/tms/web2/pythonlib
}
function vapush_eva {
    local source="${HOME}/Source/gitlab/va-product/mgmt/appliances/rbt_eva/src/bin/web2"
    local target="root@$1.lab.nbttech.com:/opt/tms/web2"
    echo "$FG[green]Syncing $FG[yellow]web2/appserver/Mgmt/Templates/ve_shared$FG[none]"
    rpush "${source}/appserver/Mgmt/Templates/ve_shared/" "${target}/appserver/Mgmt/Templates"
    echo "$FG[green]Syncing $FG[yellow]web2/appserver/Mgmt/Templates$FG[none]"
    rpush --exclude "/ve_shared" "${source}/appserver/Mgmt/Templates/" "${target}/appserver/Mgmt/Templates"
    echo "$FG[green]Flushing PSP Cache$FG[none]"
}
function mfpush {
    local source="${HOME}/Source/gitlab/mgmt-fwk/framework/src/bin/web2"
    local target="root@$1.lab.nbttech.com:/opt/tms/web2"
    echo "$FG[green]Minifying mgmt-fmk JS via $FG[yellow]rollup.sh$FG[none]"
    ${source}/html/rollup.sh
    echo "$FG[green]Syncing $FG[yellow]rollup.js and rollup.css$FG[none]"
    scp "${source}/html/rollup.js" "${target}/html"
    scp "${source}/html/rollup.css" "${target}/html"
    rm -f "${source}/html/rollup.js"
    rm -f "${source}/html/rollup.css"
    echo "$FG[green]Syncing $FG[yellow]web2/pythonlib$FG[none]"
    rpush "${source}/python/" "${target}/pythonlib"
}
function vamfpush_eva {
    vapush_eva $1
    mfpush $1
    clear_psp_cache $1
    restart_cli_service webasd $1
}
alias swtest='sw karma'
alias main-vva19='vlab main-vva19'
alias kabar-vva80='vlab kabar-vva80'
alias oak-sh835-rios1='vlab oak-sh835-rios1'
alias bigly='vlab oak-sh835-rios1'
alias virtualdva3='vlab VirtualDVA3'

function awscore {
    ssh-to awscore -i ~/.ssh/corekeypair.pem ubuntu@35.160.146.72
}
function get-awscore {
     scp -i ~/.ssh/corekeypair.pem ubuntu@35.160.146.72:$1 $2
}
function get-awscore-webui-cert {
    get-awscore /home/ubuntu/work/core/pki/certs/A_Admin.p12 $1
}
function get-awscore-cacert {
    get-awscore /home/ubuntu/work/core/pki/ca/cacert.pem ~/Source/vagrant/devcc/cc/etc/core-ca.pem
}
function add_node_autoenv {
    echo "nvm use 7.0.0\nplc nvm" > .autoenv.zsh
    echo "nvm use default\nplc" > .autoenv_leave.zsh
}

alias swsynctest="rsync --dry-run --update -rltDzh --progress"
alias swsync="rsync --update -rltDzh --progress"

function devcc {
    cd /Users/ddavis/Source/docker/devcc
    if [ $1 == "up" ]; then
        dco -p dev up
    elif [ $1 == "upb" ]; then
        dco -p dev up --build
    elif [ $1 == 'down' ]; then
        dco -p dev down
    elif [ $1 == 'sh' ]; then
        docker exec -it dev_cc_1 bash
    elif [ $1 == 'stats' ]; then
        docker stats
    fi
}

rbenv shell 2.3.3
